<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fase 4 - Aprendendo as Horas</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #333;
    }
    h2 {
      color: #fff;
      margin-bottom: 20px;
      font-size: 2.5rem;
      text-shadow: 2px 2px 6px rgba(0,0,0,0.2);
    }
    .container {
      display: flex;
      gap: 40px;
      align-items: flex-start;
      margin-bottom: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .relogio-container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .relogio {
      width: 300px;
      height: 300px;
      border-radius: 50%;
      position: relative;
      background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
      backdrop-filter: blur(8px);
      border: 2px solid rgba(255,255,255,0.3);
      box-shadow:
        0 20px 40px rgba(0,0,0,0.1),
        inset 0 1px 0 rgba(255,255,255,0.6);
      margin-bottom: 20px;
    }
    .relogio::before {
      content: '';
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 20px;
      background: #333;
    }
    /* Números de 1 a 12 */
    .relogio .numero {
      position: absolute;
      font-size: 1.2rem;
      font-weight: bold;
      color: #333;
      transform: translate(-50%, -50%);
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    .numero[data-hora="12"] { top: 8px; left: 50%; }
    .numero[data-hora="1"]  { top: 18px; left: 72%; }
    .numero[data-hora="2"]  { top: 38px; left: 87%; }
    .numero[data-hora="3"]  { top: 50%; right: 8px; }
    .numero[data-hora="4"]  { bottom: 38px; left: 87%; }
    .numero[data-hora="5"]  { bottom: 18px; left: 72%; }
    .numero[data-hora="6"]  { bottom: 8px; left: 50%; }
    .numero[data-hora="7"]  { bottom: 18px; left: 28%; }
    .numero[data-hora="8"]  { bottom: 38px; left: 13%; }
    .numero[data-hora="9"]  { top: 50%; left: 8px; }
    .numero[data-hora="10"] { top: 38px; left: 13%; }
    .numero[data-hora="11"] { top: 18px; left: 28%; }
    /* Ticks de minutos */
    .relogio .tick {
      position: absolute;
      width: 2px;
      height: 12px;
      background: #333;
      top: 0;
      left: 50%;
      transform-origin: bottom center;
    }
    .relogio .tick.minor {
      height: 6px;
      background: #555;
    }
    /* Ponteiros */
    .ponteiro {
      position: absolute;
      bottom: 50%;
      left: 50%;
      transform-origin: bottom center;
      transition: transform 0.5s ease-in-out;
    }
    .ponteiro-hora {
      width: 10px;
      height: 80px;
      background: linear-gradient(45deg, #ff6b6b, #ee5a52);
      border-radius: 5px;
      box-shadow: 0 2px 8px rgba(238,90,82,0.4);
      z-index: 3;
    }
    .ponteiro-minuto {
      width: 6px;
      height: 120px;
      background: linear-gradient(45deg, #4ecdc4, #44a08d);
      border-radius: 3px;
      box-shadow: 0 2px 8px rgba(78,205,196,0.4);
      z-index: 2;
    }
    .centro {
      position: absolute;
      width: 20px;
      height: 20px;
      background: #333;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 4;
    }
    .opcoes-container {
      display: flex;
      flex-direction: column;
      gap: 15px;
      min-width: 200px;
    }
    .opcao-hora {
      width: 120px;
      height: 50px;
      background: linear-gradient(145deg, #e3f2fd, #bbdefb);
      color: #333;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      font-weight: bold;
      cursor: grab;
      box-shadow:
        5px 5px 15px rgba(0,0,0,0.1),
        -5px -5px 15px rgba(255,255,255,0.9);
      transition: transform 0.3s cubic-bezier(0.4,0,0.2,1), box-shadow 0.3s;
      user-select: none;
    }
    .opcao-hora:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow:
        10px 10px 25px rgba(0,0,0,0.15),
        -10px -10px 25px rgba(255,255,255,0.9);
    }
    .opcao-hora.dragging {
      opacity: 0.8;
      cursor: grabbing;
    }
    .pergunta {
      font-size: 1.8rem;
      color: #fff;
      margin-bottom: 20px;
      text-align: center;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
    }
    .dropzone {
      width: 220px;
      height: 80px;
      border-radius: 15px;
      background: rgba(255,255,255,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: #fff;
      font-weight: bold;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      transition: background 0.3s, border 0.3s;
    }
    .dropzone::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.7s;
    }
    .dropzone:hover::before {
      left: 100%;
    }
    .dropzone.hover { background: rgba(255,255,255,0.3); }
    .dropzone.correct { background: #7ED321; border: none; color: #fff; }
    .dropzone.incorrect { background: #D0021B; border: none; color: #fff; }
    .botoes {
      display: flex;
      gap: 20px;
      margin-top: 20px;
    }
    .btn-novo, .btn-voltar {
      padding: 12px 24px;
      font-size: 1.2rem;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .btn-novo { background: #4CAF50; color: #fff; }
    .btn-voltar { background: #F44336; color: #fff; }
    .btn-novo:hover, .btn-voltar:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    @keyframes fadeInScale {
      from { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
      to   { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
  </style>
</head>
<body>
  <h2>Que horas são?</h2>
  <div class="pergunta" id="pergunta">Arraste a hora correta para a caixa abaixo:</div>

  <div class="container">
    <div class="relogio-container">
      <div class="relogio" id="relogio">
        <!-- Números 1 a 12 -->
        <div class="numero" data-hora="12">12</div>
        <div class="numero" data-hora="1">1</div>
        <div class="numero" data-hora="2">2</div>
        <div class="numero" data-hora="3">3</div>
        <div class="numero" data-hora="4">4</div>
        <div class="numero" data-hora="5">5</div>
        <div class="numero" data-hora="6">6</div>
        <div class="numero" data-hora="7">7</div>
        <div class="numero" data-hora="8">8</div>
        <div class="numero" data-hora="9">9</div>
        <div class="numero" data-hora="10">10</div>
        <div class="numero" data-hora="11">11</div>
        <!-- Ponteiros -->
        <div class="ponteiro ponteiro-hora" id="ponteiro-hora"></div>
        <div class="ponteiro ponteiro-minuto" id="ponteiro-minuto"></div>
        <div class="centro"></div>
      </div>
    </div>
    <div class="opcoes-container" id="opcoes-container"></div>
  </div>

  <div class="dropzone" id="dropzone">Solte a resposta aqui</div>

  <div class="botoes">
    <button class="btn-novo" onclick="novoDesafio()">Nova Pergunta</button>
    <button class="btn-voltar" onclick="window.history.back()">Voltar</button>
  </div>

  <script>
    // Gera 60 ticks ao redor do relógio
    const relogio = document.getElementById('relogio');
    for (let i = 0; i < 60; i++) {
      const tick = document.createElement('div');
      tick.className = 'tick';
      if (i % 5 !== 0) tick.classList.add('minor');
      tick.style.transform = `translateX(-50%) rotate(${i * 6}deg)`;
      relogio.appendChild(tick);
    }

    let horaCorreta = '';

    function gerarHorario() {
      const hora = Math.floor(Math.random() * 12) + 1;
      const minuto = Math.floor(Math.random() * 12) * 5;
      return { hora, minuto };
    }

    function formatarHora(h, m) {
      return h.toString().padStart(2, '0') + ':' + m.toString().padStart(2, '0');
    }

    function atualizarRelogio(hora, minuto) {
      const grauHora = ((hora % 12) + minuto / 60) * 30;
      const grauMinuto = minuto * 6;
      document.getElementById('ponteiro-hora').style.transform =
        `translateX(-50%) rotate(${grauHora}deg)`;
      document.getElementById('ponteiro-minuto').style.transform =
        `translateX(-50%) rotate(${grauMinuto}deg)`;
    }

    function gerarOpcoes(correta) {
      const opcs = [correta];
      while (opcs.length < 3) {
        const { hora, minuto } = gerarHorario();
        const f = formatarHora(hora, minuto);
        if (!opcs.includes(f)) opcs.push(f);
      }
      return opcs.sort(() => Math.random() - 0.5);
    }

    function criarOpcoes(opcs) {
      const cont = document.getElementById('opcoes-container');
      cont.innerHTML = '';
      opcs.forEach(texto => {
        const div = document.createElement('div');
        div.className = 'opcao-hora';
        div.textContent = texto;
        div.draggable = true;
        div.addEventListener('dragstart', e => {
          e.dataTransfer.setData('text/plain', texto);
          div.classList.add('dragging');
        });
        div.addEventListener('dragend', () => {
          div.classList.remove('dragging');
        });
        cont.appendChild(div);
      });
    }

    function configurarDropZone() {
      const dz = document.getElementById('dropzone');
      dz.addEventListener('dragover', e => {
        e.preventDefault();
        dz.classList.add('hover');
      });
      dz.addEventListener('dragleave', () => {
        dz.classList.remove('hover');
      });
      dz.addEventListener('drop', e => {
        e.preventDefault();
        dz.classList.remove('hover');
        const arr = e.dataTransfer.getData('text/plain');
        if (arr === horaCorreta) {
          dz.textContent = `✓ Correto! ${arr}`;
          dz.classList.add('correct');
          setTimeout(novoDesafio, 2000);
        } else {
          dz.textContent = `✗ Tente novamente`;
          dz.classList.add('incorrect');
          setTimeout(() => {
            dz.textContent = 'Solte a resposta aqui';
            dz.classList.remove('incorrect');
          }, 1500);
        }
      });
    }

    function novoDesafio() {
      const { hora, minuto } = gerarHorario();
      horaCorreta = formatarHora(hora, minuto);
      atualizarRelogio(hora, minuto);
      criarOpcoes(gerarOpcoes(horaCorreta));
      const dz = document.getElementById('dropzone');
      dz.textContent = 'Solte a resposta aqui';
      dz.classList.remove('correct', 'incorrect');
      document.getElementById('pergunta').textContent = 'Que horas o relógio está marcando?';
    }

    document.addEventListener('DOMContentLoaded', () => {
      configurarDropZone();
      novoDesafio();
    });
  </script>
</body>
</html>
